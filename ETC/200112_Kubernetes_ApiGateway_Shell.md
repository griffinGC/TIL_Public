# 200112 TIL

> 오늘은 개인적으로 궁금한 점을 바탕으로 TIL 작성



## Kubernetes

### 정의

쿠버네티스 (k8s)는 컨테이너화된 어플리케이션을 자동으로 배포, 스케일링 관리해주는 오픈소스 시스템



### 기능

- 서비스 토폴로지
  - 클러스터 토폴로지 기반 서비스 트래픽 라우팅
- 엔드포인트 슬라이스
  - 확장가능한 네트워크 앤드포이트 추적
- 자가 치유 (recovery)
  - 오류가 발생한 노드 재시작, 노드 죽었을시 다시 스케줄링, 사용자 정의 상태 체크
- 자동화된 롤아웃 롤백
  - 어플리케이션 설정 변경시 점진적인 롤아웃 수행, 모든 인스턴스 동시 종료 않도록 보장
  - 문제 발생시 변경사항 롤백
- IPv4 / IPv6 이중 스택
  - 피드와 서비스에 IPv4 / IPv6 주소 할당
- Horizontal 스케일링
  - 간단한 명령어 이용 자동으로 어플리케이션의 스케일 업 또는 다운 가능



### Ingress

- 쿠버네티스에서 HTTP(S) 기반의 L7 로드 밸런싱 기능을 제공하는 컴포넌트

- 다양한 웹 어플리케이션을 하나의 로드 밸런서로 서비스 하기 위한 기능



### Desired state

- 바라는 환경. 즉, 얼마나 많은 서버가 존재하고 몇번 포트를 이용하는지 등
- 쿠버네티스는 현재 상태를 주기적으로 모니터링하며 desired state를 계속 유지하려고 함



### Kubernetes Object

- 상태를 관리하기 위한 대상을 오브젝트라고 부름

- 수십개의 오브젝트를 제공하고 오브젝트를 추가하기 매우 쉬움

- 주요 Object

  1. __Pod__

     쿠버네티스에서 배포할 수 있는 가장 작은 단위로써 한개 이상의 컨테이너, 스토리지, 네트워크 속성을 가짐.

     컨테이너를 하나 사용하더라도 반드시 Pod으로 감싸서 관리해야함.

     같은 Pod에 속한 컨테이너는 스토리지와 네트워크를 공유하고 서로 localhost로 접속 가능함

  2. __ReplicaSet__

     Pod을 한개 이상 복제하여 관리하는 오브젝트.

     Pod을 생성하고 관리를 위해서는 ReplicaSet이 필요함

     복제할 갯수, 갯수를 체크할 라벨 선택자, 생성할 Pod의 설정값을 가지고 있음

     직접적인 사용 보다는 Deployment등 다른 오브젝트에 의해서 사용되는 경우가 많음

  3. __Service__

     네트워크와 관련된 오브젝트.

     여러개의 Pod을 바라보는 내부 로드 밸런서를 생성할 때 사용

     내부 DNS에 서비스 이름을 도메인으로 등록하기 때문에 서비스 디스커버리 역할도 함

  4. __Volume__

     저장소와 관련된 오브젝트.

     Host directory로 사용될 수도 있고, EBS 같은 스토리지를 동적으로 생성하여 사용 할 수도 있음



### 배포 방식

Desired state를 다양한 오브젝트에 라벨을 붙여 정의(yaml)하고 API 서버에 전달하는 방식 사용



### 구조

Master-Node방식

모든 명령은 Master의 API 서버를 호출하고 노드는 마스터와 통신하면서 필요한 작업을 수행.

노드에 직접 명령을 전송하는 방식이 아니라 마스터에 명령을 내리고 마스터가 노드에 접속하여 수행하는 방식







## API GATEWAY

API GATEWAY를 이용하면 클라이언트 들은 각 서비스의 엔트포인트 대신 Api Gateway로 오게됨

프록시 서버처럼 작동하며 통합적으로 Rest-api와 end point 관리 가능

여러 서비스의 end-point 관리의 어려움을 해결해줌



## Shell

### 정의

쉘이란 운영체제의 커널과 사용자간의 인터페이스

쉘 스크립팅이란 그러한 쉘에서 작동하는 스크립팅 프로그램



### 종류

1. Bash (/bin/bash)

   가장 대중적인 리눅스의 표준 쉘.

   맥, 우분투, 페도라의 기본 쉘

   bash = Korn shell + C shell

2. sh (bourne shell)

   유닉스 쉘의 오리지날 버전. 현재는 미흡한 기능들이 존재함

   상호대화형 방식이 아님

   일반유저는 `$` 사용하고, 루트 유저는`#` 를 사용함

   도커의 대다수의 컨테이너들에도 sh은 깔려있음	

3. csh (C style shell)

   `%`로 되어있음

   C언어와 유사한 언어 사용

4. Ksh (Korn shell)

   C shell의 특징들을 모두 제공하면서 처리 속도도 빠름

5. zsh

   프롬프트로 `%` 사용

   ksh에 추가적인 기능들과 플러그인을 추가한 shell





### 참고자료 

>쿠버네티스
>
>https://subicura.com/2019/05/19/kubernetes-basic-1.html
>
>Api Gateway
>
>https://meetup.toast.com/posts/201
>
>https://bcho.tistory.com/1005
>
>Shell scripting
>
>https://kangsecu.tistory.com/54

